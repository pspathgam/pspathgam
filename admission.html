<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Admission Register - Government Primary School Pethgam Wagoora</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
    /* EXISTING CSS */
    body{
        font-family: Arial, sans-serif;
        background:#eef7ff;
        margin:0;
        padding:20px;
    }

    .tab-buttons{
        display:flex;
        gap:10px;
        margin-bottom:20px;
    }

    /* 3D LOOKING BUTTONS */
    .tab-buttons button{
        background:#0b76ef;
        color:white;
        padding:10px 22px;
        border:none;
        border-radius:6px;
        font-weight:bold;
        cursor:pointer;
        box-shadow:0px 4px 0px #064a97;
        transition:0.1s;
    }
    .tab-buttons button:active{
        box-shadow:0px 1px 0px #064a97;
        transform:translateY(3px);
    }

    /* --- LOGO AND HEADER STYLES --- */
    .header-content {
        display: flex;
        align-items: center; 
        justify-content: center; 
        margin-bottom: 20px;
        text-align: center;
    }

    .school-logo {
        height: 80px; 
        width: 80px; 
        margin-right: 20px;
        border: 1px solid #ccc; 
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        font-size: 10px;
        color: #555;
        font-weight: bold;
    }

    .header-text {
        text-align: left;
    }

    h2{
        margin-top:0;
        margin-bottom: 5px; 
        font-size: 24px;
    }
    .header-text p {
        margin: 0;
        font-size: 16px;
        color: #555;
    }
    /* -------------------------------- */


    .container{
        background:white;
        padding:20px;
        border-radius:8px;
        box-shadow:0px 0px 10px #bcd4ff;
        max-width:800px;
        margin:auto;
    }

    label{
        display:block;
        margin-top:10px;
        font-weight:bold;
    }

    input, select{
        width:100%;
        padding:8px;
        margin-top:5px;
        border-radius:4px;
        border:1px solid #999;
    }

    textarea{
        width:100%;
        height:100px;
        border-radius:4px;
        border:1px solid #999;
        padding:8px;
        margin-top:5px;
    }

    /* --- PDF BUTTON STYLES (NEW) --- */
    .action-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        justify-content: center;
    }
    .pdf-btn {
        background:#dc3545; /* Red color for Download */
        color:white;
        padding:10px 15px;
        border:none;
        border-radius:6px;
        font-weight:bold;
        cursor:pointer;
        box-shadow:0px 4px 0px #970617;
        transition:0.1s;
        font-size: 16px;
        flex-grow: 1;
        max-width: 300px;
    }
    .pdf-btn:active{
        box-shadow:0px 1px 0px #970617;
        transform:translateY(3px);
    }
    /* -------------------------------- */

    .submit-btn{
        background:#28a745;
        color:white;
        padding:12px;
        border:none;
        border-radius:6px;
        width:100%;
        font-size:18px;
        margin-top:20px;
        cursor:pointer;
        font-weight:bold;
        box-shadow:0px 4px 0px #0c6c25;
        transition:0.1s;
    }
    .submit-btn:active{
        box-shadow:0px 1px 0px #0c6c25;
        transform:translateY(3px);
    }

    .section-title{
        font-size:18px;
        margin-top:25px;
        font-weight:bold;
        text-decoration:underline;
    }

    .office-use-box{
        background:#fff;
        border:2px dashed #0066cc;
        padding:20px;
        max-width:800px;
        margin:25px auto;
        border-radius:8px;
    }
</style>

</head>
<body>

<div class="tab-buttons">
    <button>Admission Register</button>
    <button>Student List</button>
    <button>Search Student</button>
</div>

<div class="container" id="admissionFormContainer"> 
    <div class="header-content">
        <div class="school-logo">
            [School Logo Image Here]
        </div>
        <div class="header-text">
            <h2><b>ADMISSION REGISTER</b></h2>
            <p>Government Primary School Pethgam Wagoora</p>
        </div>
    </div>
    <form id="admissionForm">

        <label>Admission No. (To be allotted by School)</label>
        <input type="text" placeholder="Leave Blank â€“ To be filled by Office" disabled>
        
        <label>Student Full Name</label>
        <input type="text" name="studentname" required>

        <label>Father's Name</label>
        <input type="text" name="fathername" required>

        <label>Mother's Name</label>
        <input type="text" name="mothername" required>

        <label>Date of Birth</label>
        <input type="date" name="dob" required>

        <label>Aadhaar Number</label>
        <input type="text" name="aadhaar" maxlength="12">

        <label>Gender</label>
        <select name="gender" required>
            <option value="">Select</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
        </select>
        
        <label>Blood Group</label>
        <select name="bloodgroup">
            <option value="">Select Blood Group</option>
            <option>A+</option>
            <option>A-</option>
            <option>B+</option>
            <option>B-</option>
            <option>AB+</option>
            <option>AB-</option>
            <option>O+</option>
            <option>O-</option>
            <option>Unknown</option>
        </select>

        <label>Class for Admission</label>
        <select name="class" required>
            <option value="">Select Class</option>
            <option>Nursery</option>
            <option>LKG</option>
            <option>UKG</option>
            <option>1st</option>
            <option>2nd</option>
            <option>3rd</option>
            <option>4th</option>
            <option>5th</option>
        </select>

        <label>Residential Address</label>
        <textarea name="address" required></textarea>

        <label>Mobile Number</label>
        <input type="text" name="mobile" required>

        <p class="section-title">Parents Declaration</p>

        <p style="text-align:justify;">
            I do hereby declare that the above information provided by me is true to the best of my knowledge and belief. 
            I further declare that I will abide by the rules and regulations laid down by the school and the department from 
            time to time and I will co-operate with the institution for the betterment of my ward and institution under rules 
            when sought. I hereby declare that as the Parent of above mentioned student I am giving my consent to provide 
            the AADHAAR for the demographic authentication of the student.
        </p>

        <label>
            <input type="checkbox" id="agree" required>
            I agree to the above declaration.
        </label>

        <button type="submit" class="submit-btn">Submit Admission Form</button>

    </form>

</div>

<div class="office-use-box" id="officeUseBox">
    <h3 style="text-align:center; margin-top:0;">OFFICE USE ONLY</h3>

    <label>Admission No. Allotted</label>
    <input type="text" placeholder="To be filled by Office">

    <label>Class Admitted To</label>
    <input type="text">

    <label>Date of Admission</label>
    <input type="date">

    <p style="margin-top:15px;font-weight:bold;">
        The Student is admitted on __________________.  
        All required documents, including the Birth Certificate, Residence Proof, and Transfer Certificate (if applicable),  
        have been verified and found satisfactory.
    </p>

    <br>
    <label>Signature of Parent</label>
    <input type="text">

    <label>Signature of Admission Incharge</label>
    <input type="text">

    <label>Signature of Headmaster</label>
    <input type="text">
</div>

<div class="container" style="margin-top: 20px;">
    <p style="text-align: center; font-weight: bold; margin-bottom: 10px;">Download Options</p>
    <div class="action-buttons">
        <button id="downloadForm" class="pdf-btn" data-target="admissionFormContainer">Generate & Download PDF Form</button>
        <button id="downloadRegister" class="pdf-btn" data-target="officeUseBox">Generate & Download PDF Register</button>
    </div>
</div>

<script>
    // Initialize jsPDF
    const { jsPDF } = window.jspdf;

    document.getElementById("admissionForm").addEventListener("submit", function(e){
        e.preventDefault();
        alert("Form Submitted Successfully! Data saved and ready for PDF generation.");
        // In a real app, you would send data to a server here.
    });

    /**
     * Function to capture an HTML element, convert it to an image, and save it as a PDF,
     * ensuring optimal A4 sheet fit and handling multi-page content.
     */
    function generatePDF(elementId, fileName) {
        const element = document.getElementById(elementId);

        // Temporarily remove 'disabled' attribute to capture placeholder text
        const disabledInput = element.querySelector('input[disabled]');
        let isDisabledRemoved = false;
        if (disabledInput) {
            disabledInput.removeAttribute('disabled');
            isDisabledRemoved = true;
        }

        // Use a high scale for better quality in the final PDF
        html2canvas(element, { 
            scale: 3, 
            allowTaint: true,
            useCORS: true 
        }).then(canvas => {
            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p', 'mm', 'a4'); 

            // **A4 Dimensions in mm**
            const pdfWidth = 210; 
            const pdfHeight = 297; 
            
            // Calculate image height based on canvas aspect ratio and PDF width
            const imgHeight = canvas.height * pdfWidth / canvas.width;
            
            let heightLeft = imgHeight;
            let position = 0;

            // Add first page
            pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeight);
            heightLeft -= pdfHeight;

            // Handle multi-page content
            while (heightLeft >= 0) {
                position = heightLeft - imgHeight;
                pdf.addPage();
                pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeight);
                heightLeft -= pdfHeight;
            }

            pdf.save(fileName);
        }).finally(() => {
            // Re-add the disabled attribute after capture
            if (isDisabledRemoved && disabledInput) {
                disabledInput.setAttribute('disabled', 'disabled');
            }
        });
    }

    // Event Listener for PDF Form Download
    document.getElementById("downloadForm").addEventListener("click", function(){
        const targetId = this.getAttribute('data-target');
        generatePDF(targetId, 'Admission_Form.pdf');
    });

    // Event Listener for PDF Register Download
    document.getElementById("downloadRegister").addEventListener("click", function(){
        const targetId = this.getAttribute('data-target');
        generatePDF(targetId, 'Admission_Register_Record.pdf');
    });
</script>

</body>
</html>
